
# 7 类与对相关相关话题

## 7.1 如何派生内置不可变类型并修改其实例化行为

**实际案例**

比如我们想自定义一种新类型的元组，对于传入的可迭代对象，我们只保留其中int类型且值大于0的元素，例如：

IntTuple([1, -1, 'abc', 6, ['x','y'],3]) => (1,6,3)

如何继承内置tuple实现IntTuple?


**解决方案**

继承内置tuple,并实现\_\_new\_\_.在其中修改实例化行为

## 7.2 如何为创建大量实例节省内存

**实际案例**

在某网络游戏中，定义了玩家类Player(id, name, level, ...).每有一个在线玩家，在服务器程序内则有一个Player实例。
当在线人数很多时，将产生大量实例。(如百万级)
如何降低这些大量实例的内存开销？

**解决方案**

定义类的\_\_slots\_\_属性，声明实例有哪些属性(关闭动态绑定)

## 7.3 如何让对象支持上下文管理

**实际案例**

我们实现了一个telnet客户端的类TelnetClient，调用实例的connect(),login(),interact()方法启动客户端与服务器交互，交互完毕后需要调用cleanup()方法，关闭已连接的socket，以及操作历史记录写入文件并关闭。
能否让TelnetClient的实例支持上下文管理协议，从而替代手工调用cennect(), cleanup()方法。

**解决方案**

实现上下文管理协议，即实现类的\_\_enter\_\_,\_\_exit\_\_方法
它们分别在with开始和结束时被调用




