
# 2 数据结构相关话题

## 2.1 如何在列表，字典，集合中筛选数据

在实际的编程过程中经常遇到这类问题，比如过滤列表中的负数；列出字典{'LiLei': 79,'Jim': 88, 'Lucy': 92}中高于90的项；列出集合中能被3整除的数。对于这类问题，通用的方法是使用for循环，加上if判断.但这种方法效率可能会比较低，在python中可以使用如下解决方案：

- 列表

  - 列表解析: [x for x in data if x >=0 ] recommanded
  - fliter函数: filter(lambda x: x >= 0, data)

- 字典

  - 字典解析: {k:v for k,v in d.items() if v > 90}

- 集合

  - 集合解析: {x for x in s if x % 3 == 0}

## 2.2 如何为元组中的每个元素命名，提高程序可读性

**实际案例**

对于格式固定的数据，通常使用元组来存储，如学生信息系统中数据为
固定格式:(名字，年龄，性别，邮箱)

('Jim',16,'male','jim8721@gmail.com')
('LiLei',17,'male','lilei@qq.com')
('Lucy',16,'female','lucy123@yahoo.com')

使用元组的优势就是存储相同的数据比使用字典节省空间
缺点之一是访问元组中的数据时，需要索引，降低程序可读性

解决方案：

- 方案一：定义一系列数值常量或枚举类型

- 方案二：使用标准库中collections.namedtuple代替内置tuple

## 2.3 如何根据字典中值的大小，对字典排序

**实际案例**

某班英语成绩以字典形式存储为：

{
    'LiLei':79,
    'Jim': 88,
    'Lucy':92,
    ...
}

如何根据成绩高低，计算学生排名

**解决方案**

将字典总各项转换为元组，使用内置函数sorted排序。sorted函数用C实现，且做了大量优化，但不能直接对字典进行排序，需要转化为元组。
元组比较大小的规则：如果第0个索引的值能分出大小，则剩下的元素则不在比较，若第0个索引位置的元素相同，则继续比较索引为1的元素。

方案1：将字典中的项转化为(值，键)元组。(列表解析或元组)

方案2：d.items()返回一个列表，列表中元素是(key,value)的元组，直接对此列表排序，但需要在sorted函数中设置key

sorted(d.items(), key=lambda item: item[1], reverse=True)

## 2.4 如何统计序列中元素的频度

**实际案例**

1 某随机序列中，找到出现次数最高的3个元素，他们出现的次数是多少
2 对某英文文章的单词，进行词频统计，找到出现次数最高的10个单词，它们出现的次数是多少

**解决方案**

方案1：将序列转换为字典{元素:频度}，根据字典中的值排序

这种方法不是很好，如果列表很大，需要将整个列表排序，而我们只需要最大前3个，这样显然是很浪费的
在很大的列表中找到很小的前3个，通常会使用堆，python中也有实现，heapq

方案2：使用标准库collections中的Counter对象

## 2.5 如何快速找到多个字典的公共键key

**实际案例**

西班牙足球甲级联赛，每轮球员进球统计：
第1轮：{'苏亚雷斯':1,'梅西':2,'本泽马':1,...}
第2轮：{'苏亚雷斯':2,'C罗':1,'格里兹曼':2,...}
第3轮：{'苏亚雷斯':1,'托雷斯','贝尔':1,...}
.....

统计出前N轮，每场比赛都有进球的球员

**解决方案**

领用集合set的交集操作
step1:使用字典的keys()方法，得到一个字典keys的集合
step2:使用map函数，得到每个字典keys的集合
step3:使用reduce函数，取所有字典的keys集合的交集

## 2.6 如何让字典保持有序

**实际案例**

某编程竞赛系统，对参赛选手编程解题进行计时，选手完成题目后，把该选手解题用时记录到字典中，以便赛后按选手名查询成绩。

{'LiLei': (2,43), 'HanMeimei': (5,52), 'Jim': (1,39)...}

比赛结束后，需按排名顺序一次打印选手成绩，如何实现？

**解决方案**

使用标准库colletions中的OrderedDict, 实现输入次序与迭代次序一致
以OrderedDict替代内置字典Dict,一次将选手成绩存入OrderedDict。
python3.6 的内置字典dict已经具有次序的功能，但为了代码兼容，建议还是使用OrderedDict实现字典的有序

## 2.7 如何实现用户历史记录功能(最多n条)

**实际案例**

很多应用程序都有浏览用户的历史记录的功能，例如：
1. 浏览器可以查看最近访问过的网页。
2. 视频播放器可以查看最近播放过的视频文件。
3. shell可以查看用户输入过的命令。

现在我们制作一个简单的猜数字的小游戏，如何添加历史记录功能，显示用户最近猜过的数字？


**解决方案**

使用容量为n的双端队列存储历史记录，使用标准库中的collections中的
deque，它是一个双端队列

双端队列：左右两端都可以进行入队和出队操作

双端队列的数据还是在内存中，程序退出后，历史记录就会消失，所以
需要将历史记录存储到硬盘，如文件，数据库等

使用pickle模块将历史记录存储到硬盘，以便下次启动使用。

pickle模块将Python对象持久化到硬盘，下次用pickle模块读取时直接是
Python对象。而不是文本文件。

pickle模块持久化是需要持久化的文件有写入权限，且是以二进制的方式
写入，Python默认是以文本的方式写入或读取。同样加载时使用二进制读取

